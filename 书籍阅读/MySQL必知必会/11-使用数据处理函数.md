# 使用数据处理函数

## 函数

SQL 支持使用函数来处理数据

不同的DBMS支持的函数并不完全相同, 而且有时差异很大, 这个要注意


## 使用函数

### 文本处理函数

常用文本处理函数

| 函数        | 说明                           |
| ----------- | ------------------------------ |
| Left()      | 返回串左边的字符               |
| Length()    | 返回串长度                     |
| Locate()    | 找出串的一个子串               |
| Lower()     | 将串转为小写                   |
| Upper()     | 转为大写                       |
| LTrim()     |
| RTrim()     |
| Trim()      | 去除两边空格                   |
| SubString() | 返回子串的字符                 |
| Soundex()   | 返回串的语音表示的字母数字模式 |

关于 Soundex(), 这个得到的是一种字母+数字的字符, 可以使用这个来对比相似的发音

例如, 现在在某个表中存在 name 为 `小明` 和 `小敏` 两个数据
`SELECT * FROM test WHERE Soundex(name) = Soundex('小明');` 会返回`小明`和`小敏`这两个结果


### 日期和时间函数

日期和时间采用相应的数据类型和特殊的格式存储, 以便能够快速和有效地排序或过滤, 并且节省物理存储空间

常用的日期和时间处理函数

| 函数          | 说明                                                     |
| ------------- | -------------------------------------------------------- |
| AddDate()     | 增加一个日期(天, 周等)                                   |
| AddTime()     | 增加一个时间(时, 分等)                                   |
| CurDate()     | 返回当前日期 (2021-11-29)                                |
| CurTime()     | 返回当前时间 (22:44:44)                                  |
| Date()        | 返回日期时间的日期部分                                   |
| DateDiff()    | 计算两个日期之差 (这里的结果是天数)                      |
| Date_Add()    | 高度灵活的日期运算函数                                   |
| Date_Format() | 返回一个格式化的日期或时间串                             |
| Day()         | 返回一个日期的天数部分                                   |
| DayOfWeek()   | 对于一个日期, 返回对应的星期 (这里要特别注意: 1是星期天) |
| Hour()        | 返回一个时间的小时部分                                   |
| Minute()      | 返回一个时间的分钟部分                                   |
| Second()      | 返回一个时间的秒部分                                     |
| Month()       | 返回一个日期的月份                                       |
| Now()         | 返回当前日期和时间 (2021-11-29 22:45:11)                 |
| Time()        | 返回一个日期时间的时间部分                               |
| Year()        | 返回一个日期的年部分                                     |

在MySQL 中, 日期的格式最好是 `YYYY-MM-DD`, 时间是`hh-mm-ss`

例如: 在某个数据库中, 存在一个名为 `birthdate` 的字段存储用户的出生日期
`select DateDiff(CurDate(), birthdate) / 365 as real_age from test;` // 返回 年龄


### 数值处理函数

常用数值处理函数

| 函数    | 说明                 |
| ------- | -------------------- |
| Abs()   | 绝对值               |
| Pi()    | 圆周率               |
| Ceil()  | 向上取整             |
| Floor() | 向下取整             |
| Round() | 四舍五入             |
| Rand()  | 随机数               |
| Sqrt()  | 平方根               |
| Sin()   | 返回一个角度的正弦值 |
| Cos()   | 余弦                 |
| Tan()   | 正切                 |