# 关于第三方cookie 和 samesite 设置

## 第三方cookie

第三方cookie 就是由第三方网站发出的指向非自身服务的cookie

例如在A页面上引用一个B网站的图片链接, 此时会向B发送A站点的Cookie, 这个Cookie就是第三方Cookie


### 第三方Cookie的作用

**最常见的就是用户追踪**

通过将广告(通常是图片)嵌入某个站点, 就能收集这个站点的Cookie, 从而判断用户的喜好甚至是获取用户信息

**还有一个就是跨站点攻击(CSRF)**

一个通常的例子: 用户在A站登录了, 然后访问了某个危险网站B, B网站有一个如下表单
```html
<form action=A站的某个地址 method="POST">...</from>
```
这样就能通过B站向A站发送一个带有A站cookie的信息(emmm.... 这简直是魔法)

跨站请求通常依赖一些标签能够绕过同源策略的限制的功能, 例如 `img` `script` 等



## SameSite 

这是一个cookie设置, 旨在用来限制cookie的获取. 它有三个值:

| 值     | 描述                                                                                                                               |
| ------ | ---------------------------------------------------------------------------------------------------------------------------------- |
| Strict | 最为严格，完全禁止第三方 Cookie，跨站点时，任何情况下都不会发送 Cookie。换言之，只有当前网页的 URL 与请求目标一致，才会带上 Cookie |
| Lax    | Cookies 允许与顶级导航一起发送，并将与第三方网站发起的 GET 请求一起发送。这是浏览器中的默认值。                                    |
| None   | Cookie 将在所有上下文中发送，即允许跨站发送。                                                                                      |


> 在设置 `SameSite=None` 的时候, 必须同时设置 `Secure=false | true`                                                                    

现代浏览器为了防止 `CSRF` 攻击都将 `SameSite` 默认设置为 `Lax`