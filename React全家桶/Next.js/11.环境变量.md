# 环境变量

Next.js 内置了对环境变量的支持:

- 使用`.env.local` 加载环境变量
- 通过给环境变量添加`NEXT_PUBLIC_`前缀将环境变量暴露给浏览器

## 加载环境变量

Next.js 内置支持将环境变量从 `.env.local` 加载到 `process.env` 中.

```ini
// .env.local
DB_HOST=localhost
DB_USER=myuser
DB_PASS=mypassword
```

**使用**

```js
// pages/index.js
export async function getStaticProps() {
  const db = await myDB.connect({
    host: process.env.DB_HOST,
    username: process.env.DB_USER,
    password: process.env.DB_PASS,
  });
  // ...
}
```

> 注意: Next.js 会在 `.env*` 文件中自动扩展变量, 这允许在配置中访问其他的配置

```ini
# .env
HOSTNAME=localhost
PORT=8080
# 可以通过 $ 符号范文其他配置
HOST=http://$HOSTNAME:$PORT
```

> 如果需要单纯使用 `$` 字符串, 需要加上转义字符

## 将环境变量暴露给浏览器

默认情况下, 环境变量仅在 Node.js 环境中使用. 为了向浏览器暴露环境变量, 必须在变量前面添加`NEXT_PUBLIC_`前缀.

```ini
NEXT_PUBLIC_ANALYTICS_ID=abcdefghijk
```

这将自动将 `process.env.NEXT_PUBLIC_ANALYTICS_ID `加载到 Node.js 环境中，从而允许你在代码的任何地方使用它。带有前缀 `NEXT_PUBLIC_` 的变量将被内联到发送给浏览器的 JavaScript 代码中。由于这种内联发生在构建时，因此在构建项目时需要设置好各个 `NEXT_PUBLIC_` 前缀的环境变量。

```js
// pages/index.js
import setupAnalyticsService from '../lib/my-analytics-service';

// NEXT_PUBLIC_ANALYTICS_ID can be used here as it's prefixed by NEXT_PUBLIC_
setupAnalyticsService(process.env.NEXT_PUBLIC_ANALYTICS_ID);

function HomePage() {
  return <h1>Hello World</h1>;
}

export default HomePage;
```


## 默认环境变量

`.env.local`
`.env.development`
`.env.production`
`.env.test`

