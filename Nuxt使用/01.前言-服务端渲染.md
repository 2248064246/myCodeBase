# 服务端渲染（SSR）

SSR 是 Server-Side Rendering, 即服务端渲染的缩写。

## 为什么要使用SSR

与SPA(Simple-Page Application)相比，SSR的优势主要在于：

1. 更快的首屏加载：模板的解析在服务端就完成，浏览器可以直接显示html内容，而无需想SPA一样等待关键JS下载完成后才能显示。
2. 统一的心智模型：你可以使用相同的语言以及相同的声明式、面向组件的心智模型来开发整个应用，而不需要在后端模板系统和前端框架之间来回切换。 （关于心智模型，我的理解是统一的开发时栈--开发时可以同时操作前端和后端。**就是在同一套环境下开发**）
3. 更好的SEO：搜索引擎爬虫可以直接看到完全渲染的页面。

>如果你的应用以一个 loading 动画开始，然后通过 Ajax 获取内容，爬虫并不会等到内容加载完成再抓取。也就是说，如果 SEO 对你的页面至关重要，而你的内容又是异步获取的，那么 SSR 可能是必需的。

使用SSR的一些权衡：

+ 开发中的显示，浏览器平台的API只能在某些特定生命周期中使用（对于Vue），一些外部库的使用可能需要特定处理（如果它需要使用WebAPI)
+ 更多的构建配置和部署要求：SSR需要一个能运行Node服务的环境，而不是简单的静态服务（例如Nginx）
+ 更高的服务端负载：在 Node.js 中渲染一个完整的应用要比仅仅托管静态文件更加占用 CPU 资源。

[以上说明来源 Vue 文档](https://cn.vuejs.org/guide/scaling-up/ssr.html#why-ssr)

总结：SSR适合对首屏加载特别重视的场景，以及对SEO有要求的场景。对于内部的管理平台这些，SSR就显得不是那么重要。

## SSR VS SSG

SSG 是 Server-Side Generation（静态站点生成）的缩写。也被称为预渲染，是另一种流行的构建快速网站的技术。

如果服务端渲染的一个页面对每个用户来说都是一致的，那么我们可以先将这个页面渲染出来，然后通过静态服务来返回这个页面。

这样用户在访问的时候就不需要每次都通过服务端渲染，而是请求预先渲染好的静态页面。

SSG保留的SSR的优点：快速响应，更好的SEO。同时有能使用静态服务来减少服务器负载。

SSG的关键是：数据对于所有用户一致，且数据在构建期间是已知的，还要保证数据在多次部署期间不会改变。每当数据变化时，都需要重新部署。

SSG非常适合知识库，博客，文档类的网站。

## Vue 中的SSR

Vue.js 常见的能力是在浏览器中生成和操作DOM。然而，Vue也支持将组件在服务端渲染为HTML字符串，并返回给浏览器。

Vue中使用 SSR 最好使用 `组合式API`形式来写Vue文件

## Vue 中使用SSR的通用解决方案

1. Nuxt (成熟，可靠，Vue官方推荐)
2. Quasar
3. Vite SSR
