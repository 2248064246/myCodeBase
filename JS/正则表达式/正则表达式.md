
# 正则表达式

## 定义正则表达式

+ 字面量

+ RegExp() 构造函数

## 字面量字符

所有字母字符和数字在正则表达式中都匹配自身的字面值

有一些英文标点符号在正则表达式中具有特殊意义: `^ $ . * + ? = ! : | \ / ( ) [ ] { }`

JS正则表达式语法通过 反斜杠 `\` 开头的转义序列也支持一些非字母字符

| 字符  | 匹配目标                                       |
| ----- | ---------------------------------------------- |
| \0    | NUL字符                                        |
| \n    | 换行符                                         |
| \v    | 垂直制表符                                     |
| \f    | 进纸符                                         |
| \r    | 回车符                                         |
| \u{n} | 码点n指定的Unicode字符 (n介于 0 ~ 10FFFF 之间) |

## 字符类

| 字符   | 匹配目标                                              |
| ------ | ----------------------------------------------------- |
| [...]  | 方括号中的任意一个字符                                |
| [^...] | 不在方括号中的任意一个字符                            |
| [a-z]  | 使用 - 表示字符范围                                   |
| [^a-z] | 除 a-z 的任意一个字符                                 |
| .      | 除换行或其他Unicode行终止符之外的任意字符             |
| \w     | 任意ASCII单词字符, 等同 [a-zA-Z0-9_]                  |
| \W     | 任意非ASCII单词字符, 等同 [^a-zA-Z0-9_]               |
| \s     | 任意 Unicode 空白字符(空格, 空字符, 制表符, 换页符等) |
| \S     | 任意非 Unicode 空白字符                               |
| \d     | 任意 ASCII 数字字符  等同 [0-9]                       |
| \D     | 任意非ASCII 数字字符                                  |
| [\b]   | 退格字符字面值                                        |

所有字符类转义序列本身也可以出现在方括号中, 例如 `[\s\d]` 匹配任意空白符或数字
有一个特例, \b 转义序列有一个特殊含义, 如果出现在字符类中, `\b` 表示退格字符. 
因此要在正则表达式中表示一个退格字符的字面值, 就要使用只包含一个元素的字符类 `[\b]`

## 重复
| 字符   | 含义                              |
| ------ | --------------------------------- |
| {n, m} | 匹配前项至少n次, 但不超过m次      |
| {n,}   | 匹配前项n或更多次                 |
| {n}    | 匹配前项恰好 n 次                 |
| ?      | 匹配前项 0 或 1 次, 等价于 {0, 1} |
| +      | 匹配前项1或多次, 等价于 {1,}      |
| *      | 匹配前项0或多次, 等价于 {0,}      |

## 非贪婪重复

默认情况下，像 * 和 + 这样的量词是“贪婪的”，这意味着它们试图匹配尽可能多的字符串

在重复字符后面加上 ? , 就可以指定非贪婪匹配 -- 意思是它一旦找到匹配就会停止

## 任选, 分组 和引用

| 字符         | 含义                                                                                             |
| ------------ | ------------------------------------------------------------------------------------------------ |
|              |                                                                                                  | 任选: 可以匹配左侧子表达式, 也可以匹配右侧子表达式 |
| (...)        | 分组: 将模式分为一个单元, 以便使用 *, +, ? 等, 同时记住与分组匹配的字符                          |
| (?:...)      | 仅分组:  将模式分为一个单元, 但不记住分组匹配的字符                                              |
| `(?<name>p)` | 命名捕获分组:                                                                                    |
| \n           | 匹配与第n个分组匹配相同的字符, 例如: /apple(,)\sorange\1/, \1 引用了之前()的捕获. (?:)分组不计数 |

## 锚点(断言)

| 字符    | 含义                                                             |
| ------- | ---------------------------------------------------------------- |
| ^       | 匹配字符串开头, 或者在使用 m标志时, 匹配一行的开头               |
| $       | 匹配字符串结尾, 或者在使用 m 标志时, 匹配一行的末尾              |
| \b      | 匹配单词边界 (\w 和 \W 字符之间或\w与字符串开头或末尾之间的位置) |
| \B      | 匹配非单词边界的位置                                             |
| x(?=y)  | 向前断言: x 被 y 跟随时匹配 x                                    |
| x(?!p)  | 向前否定断言:  x 没有被 y 紧随时匹配 x                           |
| (?<=y)x | 向后断言: x 跟随 y 的情况下匹配 x                                |
| (?<!y)x | 向后否定断言:  x 不跟随 y 时匹配 x                               |

向后断言和向后否定断言是ES2018扩展的, 在2020年所有浏览器厂家基本实现了这个特性

关于这个可以查看[MDN断言描述](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions/Assertions)

## 标志

每个正则表达式都可以带一个或多个标志, 用于修改其行为.

| 名称 | 含义                                                                                                       |
| ---- | ---------------------------------------------------------------------------------------------------------- |
| g    | 表示正则表达式时全局性的(global), 即全局搜索, 找到所有匹配表达式的字符                                     |
| i    | 表示不区分大小写                                                                                           |
| m    | 表示匹配应该以`多行`模式进行(多行匹配), 而且 ^ 和 $ 既匹配字符串开头和结尾, 也匹配字符串任一行的开头和结尾 |
| s    | 与 m 标志类似, 但是允许 '.' 匹配任何字符, 包括换行符                                                       |
| u    | 表示 Unicode, 可以让正则表达式匹配完整的码点而不是匹配16位值                                               |
| y    | 表示正则表达式是`有粘性的`                                                                                 |

关于 `u`:  如果没有特殊原因, 应该对所有正则表达式使用这个标志. 如果不使用, 正则表达式将无法识别表情符号和其他需要16位以上的字符, 没有u标志, '.' 匹配任意一个Utf-16 16位值, 加上`u`标志后, 将匹配一个 Unicode 码点

> 不知道是表情新增加了规范还是什么, 使用带 u 标志的正则去匹配表情, 有一些依旧会有问题

```js
let c = '❤️😂'
c.match(/./ug) // => ['❤', '️', '😂']
```



