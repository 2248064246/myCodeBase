# setup()

`setup()` 钩子是在组件中使用组合式 API 的入口, 通常只在以下情况下使用:

1. 需要在非单文件组件中使用组合式 API
2. 需要在基于选项式 API 的组件中集成基于组合式 API 的代码时.

其他情况, 优先使用 `<script setup>`

## 基本使用

`setup()` 中返回的对象会暴露给模板和组件实例

```html
<script>
  import { ref } from 'vue';

  export default {
    setup() {
      const count = ref(0);

      // 返回值会暴露给模板和其他的选项式 API 钩子
      return {
        count,
      };
    },

    mounted() {
      console.log(this.count); // 0
    },
  };
</script>

<template>
  <button @click="count++">{{ count }}</button>
</template>
```

请注意在模板中访问从 setup 返回的 ref 时，它会自动浅层解包，因此你无须再在模板中为它写` .value`。当通过 this 访问时也会同样如此解包。

> 无法在 `setup` 中使用 `this` 获取组件实例

## 访问 pros

`setup()` 函数的第一个参数是组件的 `props`. 传入 setup 的 props 是响应式的.

不要通过`解构`获取 props 的属性, 那样会属性会失去响应性.

如果确实需要解构, 并且也想保持响应性, 需要使用 `toRefs()` 或 `toRef()` 两个工具函数

```js
import { toRefs, toRef } from 'vue';

export default {
  setup(props) {
    // 将 `props` 转为一个其中全是 ref 的对象，然后解构
    const { title } = toRefs(props);
    // `title` 是一个追踪着 `props.title` 的 ref
    console.log(title.value);

    // 或者，将 `props` 的单个属性转为一个 ref
    const title = toRef(props, 'title');
  },
};
```

## setup 上下文


